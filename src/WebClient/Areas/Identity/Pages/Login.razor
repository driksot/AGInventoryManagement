@page "/login"

@inject IAuthService AuthService

<PageTitle>Log In</PageTitle>

<MudText Typo="Typo.h4" Class="card-title fw-bold mb-4 mx-auto text-center" Color="Color.Primary">
    Log In
</MudText>

<EditForm Model="LoginUser" OnValidSubmit="HandleLogin">
    <DataAnnotationsValidator />
    <MudGrid Class="w-50 mx-auto">
        <MudItem xs="12">
            <MudCard>
                <MudCardContent>
                    <MudTextField @bind-Value="LoginUser.Email" Label="Email" InputType="InputType.Email" Variant="Variant.Outlined" Class="mb-4"
                                  For="@(() => LoginUser.Email)"/>
                    <MudTextField @bind-Value="LoginUser.Password" Label="Password" InputType="InputType.Password" Variant="Variant.Outlined" Class="mb-2"
                                  For="@(() => LoginUser.Email)" />
                </MudCardContent>
                <MudCardActions Class="ms-2 pb-4">
                    <MudButton Variant="Variant.Filled"
                               StartIcon="@Icons.Material.Filled.Login"
                               Color="Color.Primary"
                               ButtonType="MudBlazor.ButtonType.Submit">
                        Log in
                    </MudButton>
                </MudCardActions>
            </MudCard>
        </MudItem>
    </MudGrid>
</EditForm>

@code {
    private LoginUser LoginUser { get; set; } = new();
    public string? Message { get; set; }

    private async Task HandleLogin()
    {
        Message = string.Empty;
        await AuthService.LoginAsync(LoginUser);
        NavManager.NavigateTo("/");
    }
}
